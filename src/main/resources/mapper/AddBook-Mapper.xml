<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.mybatis.mapper.AddBookMapper">

        <!-- 주소록 전체 셀렉(개인/공유 공용) -->
        <select id="addBookList" resultType="AddBookVO" parameterType="map">
                SELECT 
                manage_id, 
                manage_display_name, 
                manage_hp, 
                manage_email, 
                NVL(manage_remark, ' ') AS manage_remark, 
                manage_company_name,
                manage_official_name, 
                manage_dept_name, 
                manage_starred,
                b.add_book_id, 
                add_book_title, 
                code_add_id, 
                share_add_book,
                emp_id 
                FROM add_book_manage a, add_book b
                WHERE emp_id = #{empId} and a.add_book_id = b.add_book_id ORDER BY manage_id ASC
        </select>

        <!-- 주소록 특정 검색 셀렉(개인/공유 공용) -->
        <select id="addBookSearch" resultType="AddBookVO" parameterType="map">
        SELECT 
                manage_id,
                manage_display_name,
                manage_hp, 
                manage_email, 
                NVL(manage_remark, ' ') AS manage_remark, 
                manage_company_name,
                manage_official_name, 
                manage_dept_name, 
                manage_starred,
                b.add_book_id, 
                add_book_title, 
                code_add_id, 
                share_add_book,
                emp_id 
        FROM 
                add_book_manage a, 
                add_book b
        WHERE 
                emp_id = #{empId} 
                AND a.add_book_id = b.add_book_id
                <if test="selectSearch != null">
                        <choose>
                                <when test="selectSearch == 'manage_display_name'">
                                AND UPPER(manage_display_name) LIKE '%' || UPPER(#{searchText}) || '%'
                                </when>
                                <when test="selectSearch == 'manage_hp'">
                                AND UPPER(manage_hp) LIKE '%' || UPPER(#{searchText}) || '%'
                                </when>
                                <when test="selectSearch == 'manage_official_name'">
                                AND UPPER(manage_official_name) LIKE '%' || UPPER(#{searchText}) || '%'
                                </when>
                                <when test="selectSearch == 'manage_dept_name'">
                                AND UPPER(manage_dept_name) LIKE '%' || UPPER(#{searchText}) || '%'
                                </when>
                        </choose>
                </if>
                ORDER BY manage_id ASC
        </select>

        <!-- 주소록 그룹 셀렉(주소록 생성시 필요) -->
        <select id="addBookGroupSelect" resultType="AddBookVO" parameterType="map">
                SELECT 
                add_book_id, 
                add_book_title
                FROM add_book
                WHERE emp_id = #{empId} ORDER BY add_book_id ASC
        </select>

        <!-- 주소록 추가 -->
        <insert id="addBookInsert" parameterType="java.util.Map">
                INSERT INTO add_book_manage(manage_id, manage_display_name, manage_hp, manage_email, 
                                            manage_remark, manage_company_name,manage_official_name, manage_dept_name, 
                                            manage_starred,add_book_id)
                VALUES(seq_add_book_manage_no.nextval, #{manage_display_name}, #{manage_hp}
                        , #{manage_email},#{manage_remark}, #{manage_company_name},#{manage_official_name}, #{manage_dept_name}
                        , 0,#{add_book_id})
        </insert>

        <!-- 주소록 수정 -->
        
        <!-- 주소록 삭제 -->

        <!-- 주소록 그룹별 셀렉(개인/공유 공용) -->

        <!-- 주소록 그룹 추가(개인/공유 공용) -->

        <!-- 주소록 그룹 삭제(개인/공유 공용) -->

        <!-- 주소록 그룹 수정(개인/공유 공용) -->
</mapper>